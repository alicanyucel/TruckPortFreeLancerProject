<nav class="navbar">
  <div class="navbar-container">
    <div class="navbar-brand">
      <a routerLink="/" 
         class="brand-link" 
         (click)="navigateToHome()"
         [attr.aria-label]="'Ana sayfaya git'">
  <img src="assets/truck.png" alt="TruckPort Logo" class="brand-logo">
      </a>
    </div>
    
    
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" 
            [class.active]="isMobileMenuOpen" 
            (click)="toggleMobileMenu()"
            aria-label="Menüyü aç/kapat">
  <span class="hamburger-line"></span>
  <span class="hamburger-line"></span>
  <span class="hamburger-line"></span>
    </button>
    
    <ul class="navbar-menu" [class.show]="isMobileMenuOpen">
      <li class="navbar-item">
        <a routerLink="/" 
           class="navbar-link" 
           routerLinkActive="active" 
           [routerLinkActiveOptions]="{exact: true}"
           (click)="navigateToHome(); closeMobileMenu()">{{'navbar.home' | translate}}</a>
      </li>
       <li class="navbar-item">
        <a routerLink="/map"
           class="navbar-link"
           routerLinkActive="active"
           (click)="closeMobileMenu()">{{ 'navbar.services' | translate }}</a>
      </li>
      <li class="navbar-item">
        <a routerLink="/nakliye-talepleri" 
           class="navbar-link" 
           routerLinkActive="active"
           (click)="closeMobileMenu()">{{'navbar.transportRequests' | translate}}</a>
      </li>
      <li class="navbar-item">
        <a routerLink="/truckstore" 
           class="navbar-link" 
           routerLinkActive="active"
           (click)="closeMobileMenu()">{{'navbar.truckStore' | translate}}</a>
      </li>
     
      <!-- Profile dropdown (desktop) -->
      <li class="navbar-item profile-item" *ngIf="isAuthenticated">
        <button class="profile-btn" (click)="toggleProfileDropdown($event)" aria-haspopup="true" [attr.aria-expanded]="isProfileDropdownOpen">
          <img src="assets/truck.png" alt="avatar" class="profile-avatar">
          <span class="profile-name">{{profileDisplayName}}</span>
          <i class="fa fa-caret-down profile-caret" aria-hidden="true"></i>
        </button>
        <ul class="profile-dropdown" [class.open]="isProfileDropdownOpen" role="menu">
          <li role="menuitem"><a routerLink="/profil" (click)="closeProfileDropdown(); closeMobileMenu()">{{'navbar.profile' | translate}}</a></li>
          <li role="menuitem"><a routerLink="/settings" (click)="closeProfileDropdown(); closeMobileMenu()">{{'navbar.settings' | translate}}</a></li>
          <li role="menuitem"><a routerLink="/reservations" (click)="closeProfileDropdown(); closeMobileMenu()">{{'navbar.reservations' | translate}}</a></li>
          <li role="menuitem"><a routerLink="/favorites" (click)="closeProfileDropdown(); closeMobileMenu()">{{'navbar.favorites' | translate}}</a></li>
          <li role="menuitem"><a routerLink="/invoices" (click)="closeProfileDropdown(); closeMobileMenu()">{{'navbar.invoices' | translate}}</a></li>
          <li role="menuitem"><a routerLink="/help" (click)="closeProfileDropdown(); closeMobileMenu()">{{'navbar.help' | translate}}</a></li>
          <li role="menuitem"><button class="logout-link" (click)="logout(); closeProfileDropdown(); closeMobileMenu()">{{'navbar.logout' | translate}}</button></li>
        </ul>
      </li>
      
      <li class="navbar-item">
        <a routerLink="/video-galeri" 
           class="navbar-link" 
           routerLinkActive="active"
           (click)="closeMobileMenu()">{{'navbar.videoGallery' | translate}}</a>
      </li>
      <li class="navbar-item" *ngIf="!isAuthenticated">
        <a id="registerLink" routerLink="/uye-ol" 
           class="navbar-link" 
           routerLinkActive="active"
           (click)="closeMobileMenu()">{{ 'login.register' | translate }}</a>
      </li>
      <li class="navbar-item" *ngIf="!isAuthenticated">
        <a id="loginLink" routerLink="/giris"
           class="navbar-link"
           routerLinkActive="active"
           (click)="closeMobileMenu()">{{ 'navbar.login' | translate }}</a>
      </li>

      <!-- Cookie quick panel placed next to Kayıt Ol (register) for better alignment -->
      <li class="navbar-item">
        <button type="button" class="navbar-link cookie-toggle" (click)="toggleCookiePanel()" aria-expanded="showCookiePanel">{{'cookies.title' | translate}}</button>
        <div class="cookie-panel" *ngIf="showCookiePanel" [ngClass]="{ 'flip-right': cookiePanelFlip }">
          <div class="cookie-header">
            <h4>{{'cookies.title' | translate}}</h4>
            <button type="button" class="cookie-close" (click)="toggleCookiePanel()" aria-label="close"><i class="fa fa-times" aria-hidden="true"></i></button>
          </div>

          <div class="cookie-row"><label>{{'cookies.email' | translate}}</label><input placeholder="example@domain.com" aria-label="email" [(ngModel)]="cookieEmail" /></div>
          <div class="cookie-row" style="position:relative;">
            <label>{{'cookies.password' | translate}}</label>
            <input [type]="showCookiePassword ? 'text' : 'password'" placeholder="••••••••" aria-label="password" [(ngModel)]="cookiePassword" />
            <button type="button" class="cookie-eye" (click)="toggleCookiePassword()" [attr.aria-pressed]="showCookiePassword" [title]="showCookiePassword ? 'Gizle' : 'Göster'"><i class="fa" [ngClass]="showCookiePassword ? 'fa-eye-slash' : 'fa-eye'" aria-hidden="true"></i></button>
          </div>
          <div class="cookie-row"><label>{{'cookies.theme' | translate}}</label><input placeholder="dark | light" aria-label="theme" [(ngModel)]="cookieTheme" /></div>
          <div class="cookie-row"><label>{{'cookies.language' | translate}}</label><input placeholder="tr | en" aria-label="language" [(ngModel)]="cookieLang" /></div>

          <div class="cookie-actions">
            <button type="button" class="ts-btn save" (click)="saveCookies()"><i class="fa fa-save" aria-hidden="true"></i>&nbsp;{{'common.save' | translate}}</button>
            <button type="button" class="ts-btn refresh" (click)="cancelCookies()"><i class="fa fa-undo" aria-hidden="true"></i>&nbsp;{{'common.cancel' | translate}}</button>
            <button type="button" class="ts-btn delete-all" (click)="deleteAllCookies()"><i class="fa fa-trash" aria-hidden="true"></i>&nbsp;{{'cookies.deleteAll' | translate}}</button>
          </div>

          <div class="cookie-list">
            <ul>
              <li *ngIf="(cookieList | keyvalue).length === 0" class="cookie-empty">{{'cookies.empty' | translate}}</li>
              <li *ngFor="let k of (cookieList | keyvalue)">
                <div style="display:flex; align-items:center; gap:8px;">
                  <span class="cookie-key">{{ displayKey(k.key) }}</span>
                  <span class="cookie-val">{{ displayValue(k.key, k.value) }}</span>
                </div>
                <button type="button" class="ts-btn small" (click)="deleteCookie(k.key)"><i class="fa fa-times" aria-hidden="true"></i></button>
              </li>
            </ul>
          </div>
        </div>
      </li>

      <!-- Profile links duplicated for mobile menu when authenticated -->
      <ng-container *ngIf="isAuthenticated">
        <li class="navbar-item mobile-profile-item">
          <a routerLink="/profil" class="navbar-link" (click)="closeMobileMenu()">{{'navbar.profile' | translate}}</a>
        </li>
        <li class="navbar-item mobile-profile-item">
          <a routerLink="/settings" class="navbar-link" (click)="closeMobileMenu()">{{'navbar.settings' | translate}}</a>
        </li>
        <li class="navbar-item mobile-profile-item">
          <a routerLink="/reservations" class="navbar-link" (click)="closeMobileMenu()">{{'navbar.reservations' | translate}}</a>
        </li>
      </ng-container>
      
  <!-- Authentication Section -->
      <li class="navbar-item" *ngIf="isAuthenticated">
  <button class="navbar-link logout-btn" (click)="logout(); closeMobileMenu()">{{ 'navbar.logout' | translate }}</button>
      </li>
      
    </ul>
  </div>
</nav>
